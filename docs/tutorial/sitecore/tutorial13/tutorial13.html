---
layout: DocsLayout
title: Tutorial 13 - Windsor Construction
---

{% include pageheader.html %}
<p>
    With Glass you can turn on Castle Windsor construction so that your models are instantiated by the Castle
    Windsor container. You might ask why you would want to do this, well it allows you to combine services
    with data mapped from Sitecore in one call. 
</p>
<p>
    To demo this I am going to create a landing page that lists out RSS feed items. I want the URL to the RSS
    feed to specified in Sitecore along with the number of articles I want to display. My model will look like 
    this:
</p>
<pre class="github cs"  ref="gh-pages">
using System.Collections.Generic;
using System.Linq;
using System.ServiceModel.Syndication;
using Glass.Mapper.Sites.Sc.Services.BbcNews;

namespace Glass.Mapper.Sites.Sc.Models.Landing
{

    public class RssLanding
    {
        private readonly IRssService _service;

        public virtual string RssUrl { get; set; }

        public virtual int Number { get; set; }

        public virtual string Title { get; set; }

        public RssLanding(IRssService service)
        {
            _service = service;
        }

        public IEnumerable&lt;SyndicationItem&gt; GetArticles()
        {
            var result = _service.GetArticles(RssUrl);
            return result.Take(Number);
        }
    }
}
</pre>
<p>
    Notice that the constructor on my model takes an RSS Service, I need to get Castle Windsor to load this service
    and also tell Glass.Mapper to use the Windsor Construction. We need to update the GlassMapperSc class in the 
    App_Start folder, first we create an instance of the Config class and set the UseWindsorConstructor property
    to true:
</p>
<pre class="cs">
    var config = new Config();
    config.UseWindsorContructor = true;
</pre>
<p>
    Now we need to load our new services in to the Windsor Container:
</p>
<pre class="cs">
    //create the resolver
    container.Install(new SitecoreInstaller(config));
    container.Install(new ServiceInstaller());
</pre>
<p>
    I have created a ServiceInstaller to ensure I keep my code organised:
</p>
<pre class="github cs"  ref="gh-pages">
using Castle.MicroKernel.Registration;
using Castle.MicroKernel.SubSystems.Configuration;
using Castle.Windsor;
using Glass.Mapper.Sites.Sc.Services.BbcNews;

namespace Glass.Mapper.Sites.Sc.App_Start
{
    public class ServiceInstaller : IWindsorInstaller
    {
        public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            container.Register(
                    Component.For&lt;IRssService&gt;().ImplementedBy&lt;RssService&gt;().LifestyleTransient()
                );
        }
    }
}
</pre>
<p>
    I now have my container setup and Glass.Mapper ready to use, lets look at the sublayout code:
</p>
<pre class="github xml"  ref="gh-pages">
&lt;%@ Control Language="C#" AutoEventWireup="true" CodeBehind="RssLandingSublayout.ascx.cs" Inherits="Glass.Mapper.Sites.Sc.layouts.Site.Landing.RssLandingSublayout" %&gt;
&lt;h2&gt;&lt;%=Model.Title %&gt;&lt;/h2&gt;

&lt;ul class="thumbnails"&gt;
    &lt;% foreach (var article in Model.GetArticles())
       { %&gt;
    &lt;li class="span4"&gt;
    &lt;div class="thumbnail"&gt;
      &lt;h3&gt;&lt;a href="&lt;%=article.Links.First().Uri.ToString() %&gt;"&gt;&lt;%=article.Title.Text %&gt;&lt;/a&gt;&lt;/h3&gt;
      &lt;p&gt;&lt;%=article.Summary.Text %&gt;&lt;/p&gt;
    &lt;/div&gt;
  &lt;/li&gt;
    &lt;% } %&gt;
&lt;/ul&gt;

</pre>
<pre class="github cs" ref="gh-pages">
using Glass.Mapper.Sc.Web.Ui;
using Glass.Mapper.Sites.Sc.Models.Landing;

namespace Glass.Mapper.Sites.Sc.layouts.Site.Landing
{
    public partial class RssLandingSublayout : GlassUserControl&lt;RssLanding&gt;
    {
    }
}
</pre>
<p>
    My sublayout still remains really simple.
</p>
<p>
    Finally in Sitecore I just need to set the  RSS URL and number or articles to display:
</p>
<img src="tutorial13.item.PNG" class="img-polaroid"/>
<p>
    Once we publish everything and load the page we can see the RSS feed items rendered:
</p>
<img src="tutorial13.webpage.PNG" class="img-polaroid"/>
<div class="alert">
    Current you cannot mix Castle Windsor constructor injection with Glasses standard constructor injection.
</div>
<p>
    In this tutorial we have seen how you can enable the Castle Windsor construction to allow you to create a class
    that contains both Sitecore data and service in a single call.
</p>
<p>
    <a href="../tutorial14/tutorial14.html">Tutorial 14 - MVC Page Editor Support</a>
</p>
